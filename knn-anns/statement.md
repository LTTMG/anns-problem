## KNN

$d$ 维空间中有 $n$ 个点，其中编号为 $i$ 的点 $p_i$ 的坐标为 $(c_{i,1},c_{i,2},\cdots,c_{i,d})$。定义两个点 $p_u,p_v$ 之间的距离为：

$$\text{dist}(p_u,p_v)=\sqrt{\sum_{i=1}^{d}(c_{u,i}-c_{v,i})^2}$$

对于每个点，求与其距离最近的 $k$ 个点（不包含它本身）的编号。为了避免歧义，当有多个点距离相同时，编号较小的结点优先。

**输入格式**

第一行三个整数 $n,d,k$；

接下来 $m$ 行，每行 $d$ 个整数。其中第 $i$ 行第 $j$ 个数表示 $c_{i,j}$。


**输出格式**

$n$行，每行 $k$ 个整数。其中第 $i$ 行的第 $j$ 个数表示离第 $i$ 个结点第 $j$ 近的结点的编号。

**样例输入**

```
5 2 2
0 0
1 0
0 1
0 2
1 1
```

**样例输出**

```
2 3
1 5
1 4
3 5
2 3
```

**限制与约定**

$1\leq n\leq 10^3$, $1\leq d\leq 128$, $1\leq k\leq 20$, $|c_{i,j}|\leq 10^9$，$n^2d\leq 2\times 10^7$.

## ANNS

给定 $d$ 维空间中的 $n$ 个点，以及一个查询坐标 $q=(q_1,q_2,\cdots, q_d)$，近似最近邻搜索(ANNS)问题旨在从上述 $n$ 个点中查找距查询坐标 $q$ 距离较近的点。

基于图的ANNS算法是解决ANNS问题的一种常用方法。它主要分为两个部分：建图及搜索。

在建图过程中，基于图的ANNS算法将 $d$ 维空间中的点看做图中的结点，并将图中的结点按某种规则连边，以辅助搜索过程。

一种简单的基于图的ANNS算法的搜索流程如下：

1. 初始化当前结点 $cur$ 为搜索起始结点 $s$;

2. 遍历 $cur$ 的所有出边，计算 $cur$ 的所有后继离查询坐标 $q$ 的距离。

3. 如果 $cur$ 的某个后继 $cur'$ 距 $q$ 较 $cur$ 更近，则将 $cur$ 更新为 $cur'$并重复(2)；否则，算法认为 $cur$ 为距搜索坐标最近的点并中止搜索过程。

现在给出 $d$ 维空间中的 $n$ 个点，$q$ 个查询坐标，以及基于图的ANNS算法建出的图，请实现搜索过程。为了避免歧义，当有多个点距离相同时，编号较小的结点优先。

**输入格式**

第一行四个整数 $n,d,m,q$，分别表示点数，空间维数，图的边数，查询的数量；

接下来 $n$ 行，每行 $d$ 个整数，表示各点的坐标；

接下来 $m$ 行，每行两个整数 $u,v$，表示结点 $u$ 到结点 $v$ 有一条有向边。

接下来 $q$ 行，每行 $1+d$ 个整数：

* 第一个数是本次查询的起始结点 $s$；

* 接下来 $d$ 个数为查询坐标。


**输出格式**

$q$ 行，每行一个整数。表示上述ANNS算法的查询结果。

**样例输入**

```
5 2 6 3
0 0
1 0
0 1
0 2
1 1
1 3
2 5
3 4
3 5
4 3
5 3
1 1 2
2 -1 0
4 1 1
```

**样例输出**

```
4
2
5
```

**样例解释**

![](https://github.com/LTTMG/anns-problem/blob/master/knn-anns/res/pic1.png)

蓝色结点为搜索起始结点，绿色结点为搜索终止结点，橙色结点为查询坐标，红色箭头为搜索路径。

**限制与约定**

$1\leq n\leq 10^3$, $1\leq d\leq 16$, $1\leq m\leq 5\times 10^3$, $1\leq q\leq 10^3$, 各点坐标绝对值 $\leq 10^9$.